doctype
head
  title Goji Integration Guide
  link(rel="icon" href="favicon.ico" type="image/png")
  style
    include styles.css
body
  .main
    img(src = 'goji.jpg' style = 'width:100px')
    :markdown
      # Goji Innovative Finance ISA Integration Guide

      ##### v0.1.0 Monday 11th January 2015

      ## Legal Note

      This document is the property of Goji Holdings Limited. It may not be reproduced, stored in a retrieval system or transmitted in any form or by any means, either in whole or in part, without prior written permission of Goji Holdings Limited. Goji Holdings Limited is the owner of the intellectual property rights of this document. All such rights are reserved.
      You may download extracts, of any page(s) from this document for your personal reference. You must not modify the paper or digital copies of this document in any way, and you must not use any illustrations or any graphics separately from any accompanying text.

      ## Table of Contents

      * [Introduction](#introduction)
      * [API Integration](#api-integration)
        * [Changes to Originator's Systems Data Structures](#data-structures)
        * [Lifecycle Integration Points](#lifecycle-integration)
          * [Opening an ISA](#opening-isa)
          * [Cooling Off Period](#cooling-off)
        * [Funding an ISA](#funding-isa)
          * [Validation](#funding-validation)
          * [Cash Deposits](#cash-deposits)
          * [Transferring Funds](#funds-transfer)
          * [Transferring from an existing ISA](#transfers-in-intro)
        * [Investing](#investing)
          * [Earmarking money](#earmarking)
          * [Create Investment](#create-investment)
          * [Repayments](#repayments)
          * [Reinvestments](#reinvestments)
        * [Withdrawing Funds](#withdrawing-funds)
        * [Edit Investor Details](#edit-investor)
      * [Admin Console](#admin-console)
        * [ISA Workflows](#isa-workflows)
          * [Transfers In](#transfers-in)
          * [Transfers Out](#transfers-out)
          * [Repairing and Voiding ISAs](#repair-void)
            * [Voiding an ISA](#voiding)
            * [Repairing an ISA](#repairing)
          * [Death of Investor](#investor-death)
      * [Regulatory Reporting](#reporting)


      ## <a name="introduction"></a> Introduction

      The Goji Innovative Finance ISA Platform (Goji Platform) provides the admin, regulatory and compliance functionality necessary for a Peer To Peer Platform (Originator) to
      provide their customers with the ability to wrap their investments in an IF ISA.

      The Goji Platform provides a number of key features to deliver the ISA functionality:

      * Regulatory reporting to HMRC
      * Workflow management for ISA admin tasks eg transferring an ISA in/out, death of investor etc.
      * Business rule validation on data input

      This document details how an Originator integrates with the Goji Platform.
      The intended audience of this document are the developers and analysts responsible for building the integration between the Originator's systems and the Goji Platform.

      The Goji Platform requires data from the Originator at a number of points in the Investor lifecycle to facilitate HMRC reporting, process workflow management and data validation.

      Additionally, the Goji platform provides an admin interface to allow Originators to and Goji staff to manage ISA specific workflows eg transfers in/out,
      repairing/voiding ISAs, death of investor etc.

      ## <a name="api-integration"></a> API Integration

      The Goji Platform exposes a RESTful API over HTTPS. Full details of the API are available in [separate documentation](https://goji-api.herokuapp.com/docs).

      Data will need to be submitted to the Goji Platform at the following points in an Investor's lifecycle.

      ### <a name="data-structures"></a> Changes to Originator system's data structures

      To successfully integrate with the Goji Platform, the Originator's systems will need to be altered to allow an Investor to have both a 'standard' investment account and an IF ISA account.

      ### <a name="lifecycle-integration"></a> Investor Lifecycle Integration Points

      #### <a name="opening-isa"></a> Opening an ISA

      When a customer on the Originator's platform elects to open an ISA, a call will need to be made to the Goji Platform to create the Investor.

           POST /investors

      Validation will be performed to ensure that the data provided is a) valid and b) includes the data needed to comply with HMRC reporting.
      We also validate that the Investor has not already opened an IF ISA on the Goji Platform with another Originator in the current tax year.

      It is assumed that the Originator has already performed KYC and AML check by this point.

      Once the Investor has been created on the Goji Platform they need to agree to the ISA declaration and terms and conditions.

      The latest version of these can be returned from the API:

           GET /investors/{investorId}/terms

      A record of the Investor agreeing to both documents needs to be recorded:

           POST /investors/{investorId}/terms

      ##### <a name="cooling-off"></a> Cooling off period

        At this point the ISA is considered 'provisionally opened'. It is not fully opened until a deposit is made. Once provisionally opened,
        a cooling off period is applied during which the Investor can close the ISA free of charge.

        The current state of the ISA can be checked:

             GET /investors/{investorId}/isa

      #### <a name="funding-isa"></a> Funding an ISA

      The Investor's ISA can be funded by depositing cash, transferring funds from an existing account with the Originator
      or by transferring in an ISA held with another ISA manager.

      ##### <a name="funding-validation"></a> Validation

      When money is added to the ISA account, validation is applied to ensure the annual subscription amount is not exceeded.
      The transfer will be rejected in whole if it exceeds the limit.
      The remaining maximum deposit amount is returned on the ISA details endpoint:

           GET /investors/{investorId}/isa

      ##### <a name="cash-deposit"></a> Cash deposit

      If an Investor deposits money to their IF ISA account, this needs to be recorded on the Goji Platform:

           POST /investors/{investorId}/cash

      ##### <a name="funds-transfer"></a> Transferring funds from an existing account

      If an Investor transfers money from an existing investment account on the Originator's platform to their IF ISA, this similarly needs to be recorded as a cash transaction:

           POST /investors/{investorId}/cash

      ##### <a name="transfers-in-intro"></a> Transfers in

      If an Investor holds an existing cash/stocks and shares ISA with another ISA manager, the Investor can elect to transfer that balance to another ISA Manager.
      Please see the section below which details how the Transfers In/Out process works.

      #### <a name="investing"></a> Investing

      Once an Investor has funded their account and the cooling off period has expired, they can invest their money.

      ##### <a name="earmarking"></a> Earmarking funds

      Earmarking funds is necessary if an Investor has committed an amount of money to an investment but the funds have not been drawn down yet.
      This is required if an Investor is bidding on an investment or if they have added their money to a lending queue which will get drawn down when it is matched.

      Money can be earmarked with the following call:

           POST /investors/{investorId}/earmarkedAmount

      This reduces the available cash balance of the ISA.

      If an Investor is unsuccessful in their investment bid or if they want to remove their money from the offer or queue, the earmarked amount should be deleted:

           DELETE /investors/{investorId}/earmarkedAmount/{earmarkedAmountId}

      If the earmarked amount is converted into an investment, this needs to be converted to an investment on the Goji Platform:

           POST /investors/{investorId}/earmarkedAmount/{earmarkedAmountId}/investment

      ##### <a name="create-investment"></a> Creating an investment

      If an Investor can invest their money without going via an auction or queue, the investment should be created directly.

           POST /investors/{investorId}/investment

      This will reduce the cash balance available on the ISA.

      ##### <a name="repayments"></a> Repayments

      When the borrower makes a repayment against a loan, this repayment needs to be recorded on the Goji Platform.
      A repayment increases the cash balance on an ISA by the interest component of the repayment.
      If the repayment is automatically re-invested, please see the [Reinvestments](#reinvestments) section below.

           POST /investors/{investorId}/investment/{investmentId}/repayment

      ##### <a name="reinvestments"></a> Reinvestments

      When a borrower makes a repayment against a loan, this repayment needs to be recorded on the Goji Platform.
      A reinvestment differs from a repayment in that a reinvestment automatically invests the repaid capital and interest.
      The balance of the ISA is increased by the interest portion of the reinvestment.

           POST /investors/{investorId}/investment/{investmentId}/reinvestment

      ##### <a name="sale"></a> Sale of loans

      A loan can be considered 'sold' when it has a capital outstanding of zero. To this end, there is no need to make a specific call to mark a loan as sold, it can just be processed as a normal repayment.

      If a loan has been sold for more or less than the capital outstanding amount (eg in an auction), then there is a specific endpoint that can be called:

           POST /investors/{investorId}/investment/{investmentId}/sale

      ##### <a name="writeOffs"></a> Defaults and write offs

      If a loan has defaulted and either all or a portion of the loan should be written off, the write off endpoint can be called. This will reduce the ISA balance by the write off amount.

           POST /investors/{investorId}/investment/{investmentId}/writeOff

      If repayments need to be made after the full balance has been written off (eg recoveries), these should be processed as interest repayments.

      #### <a name="withdrawing-funds"></a> Withdrawing funds

      An Investor can withdraw funds up to the cash balance available on the ISA.
      The amount that can be withdrawn is available from the ISA details:

           GET /investors/{investorId}/isa

      When a user withdraws cash, this needs to be recorded on the Goji Platform as a cash transaction:

           POST /investors/{investorId}/cash

      #### <a name="edit-investor"></a> Editing investor details

      If an Investor's details need to be updated eg they change address, this needs to be reflected on the Goji platform:

           PUT /investors/{investorId}

      ## <a name="admin-console"></a> Admin Console

      The Goji Platform Admin Console allows Originator and/or Goji Customer Service Agents (CSA) to perform ISA admin tasks.

      All activity on the console is fully audited and secured by an authentication and authorisation model.

      ### <a name="isa-workflows"></a> ISA Workflows

      The following workflows for ISA management are supported on the Admin Console.

      #### <a name="transfers-in"></a> Transfers In

      A 'transfer in' is the process where an Investor moves the cash balance of an existing Cash and/or stocks and shares ISA from another ISA Manager to the Originator's platform.

      An Investor-facing web application will guide the Investor through the steps necessary to facilitate this process.
      Once the process is complete, Goji will transfer the transferred funds to the Originator and make a call to the Originator platform to indicate the transfer has completed and the funds are cleared.

      The Originator platform will need to expose a mechanism for being notified that the funds have cleared.

      #### <a name="transfers-out"></a> Transfers Out

      A 'transfer-out' is the process where an Investor elects to move their IF ISA from the Originator to an alternative ISA Manager.
      The new ISA Manager will contact Goji who will perform the checks necessary to validate that the transfer request is genuine.

      Once this validation has been performed, Goji will instruct the Originator to liquidate the portion of the IF ISA necessary to meet the requirements of the ISA.

      The Originator platform will need to expose a mechanism to allow an IF ISA to be liquidated and transferred to a designated bank account.

      #### <a name="repair-void"></a> Repairing / voiding ISAs

      If HMRC deem that an Investor has breached one/many ISA regulations eg opened two IF ISAs in one tax year, then an ISA may need to be voided or repaired.

      ##### <a name="voiding"></a> Voiding an ISA

      A voided ISA is one that is no longer eligible to be tax exempt. Goji will complete the verification, admin and tax submissions required for this process.

      The Originator platform will need to expose a mechanism to allow an ISA account (cash balance and investments) to be transferred to a 'standard' account.

      ##### <a name="repairing"></a> Repairing an ISA

      A repaired ISA is one where a portion of the balance is no longer eligible to be tax exempt. Goji will complete the verification, admin and tax submissions required for this process.

      The Originator platform will need to expose a mechanism to allow a portion of an ISA account (cash balance and investments) to be transferred to a 'standard' account.

      #### <a name="investor-death"></a> Death of Investor

      In the event of a death of an Investor, specific tasks needed to be carried out to process the tax liability of the ISA-wrapped investments.

      The Goji Admin Console will guide a CSA through this process.

      ## <a name="reporting"></a> Reporting

      The Goji Platform will automatically generate and submit all reporting required by HMRC based on the data provided.
